[gd_scene format=3 uid="uid://dasygi206clwu"]

[ext_resource type="Script" uid="uid://byxnatvcndpcu" path="res://assets/general/entity_stats.gd" id="1_entity"]
[ext_resource type="Script" uid="uid://casw3xipe2xlc" path="res://assets/enemies/flight_enemy.gd" id="2_flight"]
[ext_resource type="PackedScene" uid="uid://x3cdtgoi7224" path="res://assets/new_projectile.tscn" id="3_projectile"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_body"]
resource_local_to_scene = true
albedo_color = Color(0.4, 0.2, 0.6, 1)
metallic = 0.3
roughness = 0.7
emission = Color(0.50928617, 0.50928617, 0.50928617, 1)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_body"]
height = 1.5

[sub_resource type="SphereShape3D" id="SphereShape3D_coll"]
radius = 2.5843709

[sub_resource type="Animation" id="Animation_1cakt"]
resource_name = "RESET"
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:material_override:emission_enabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:material_override:emission")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(0.50928617, 0.50928617, 0.50928617, 1)]
}

[sub_resource type="Animation" id="Animation_qysnd"]
resource_name = "flash"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:material_override:emission_enabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [true, false]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:material_override:emission")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1.5691684, 1),
"update": 0,
"values": [Color(0.6187021, 0.46343356, 0.43606433, 1), Color(0, 0, 0, 1)]
}

[sub_resource type="Animation" id="Animation_xkaar"]
resource_name = "flash_death"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:material_override:emission_enabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:material_override:emission")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1.5691684),
"update": 0,
"values": [Color(0.38956866, 0.27445075, 0.25452647, 1)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_0r4wo"]
_data = {
&"RESET": SubResource("Animation_1cakt"),
&"flash": SubResource("Animation_qysnd"),
&"flash_death": SubResource("Animation_xkaar")
}

[sub_resource type="Animation" id="Animation_fyw40"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Visual:scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(10, 10, 10)]
}

[sub_resource type="Animation" id="Animation_dtifb"]
resource_name = "death"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Visual:scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.79),
"transitions": PackedFloat32Array(5.656855, 1),
"update": 0,
"values": [Vector3(10, 10, 10), Vector3(0, 0, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_jj6un"]
_data = {
&"RESET": SubResource("Animation_fyw40"),
&"death": SubResource("Animation_dtifb")
}

[node name="FlightEnemyNode" type="CharacterBody3D" unique_id=361403220 node_paths=PackedStringArray("flash_animator", "death_animator")]
collision_layer = 4
collision_mask = 5
script = ExtResource("2_flight")
projectile_scene = ExtResource("3_projectile")
inaccuracy_curve_param = 1.0000017
flash_animator = NodePath("Animators/FlashAnimator")
death_animator = NodePath("Animators/DeathAnimator")

[node name="EntityStats" type="Node" parent="." unique_id=2014315709]
script = ExtResource("1_entity")
health = 20.0
max_health = 20.0
metadata/_custom_type_script = "uid://byxnatvcndpcu"

[node name="Visual" type="Node3D" parent="." unique_id=210956206]
transform = Transform3D(10, 0, 0, 0, 10, 0, 0, 0, 10, 0, 0, 0)

[node name="Body" type="MeshInstance3D" parent="Visual" unique_id=33622026]
transform = Transform3D(1, 0, 0, 0, 0, 1, 0, -1, 0, 0, 0, 0.05741)
material_override = SubResource("StandardMaterial3D_body")
mesh = SubResource("CapsuleMesh_body")

[node name="CollisionShape3D" type="CollisionShape3D" parent="." unique_id=705466686]
transform = Transform3D(5, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0)
shape = SubResource("SphereShape3D_coll")

[node name="ProjectileSpawn" type="Node3D" parent="." unique_id=537837099]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -1.2)

[node name="Animators" type="Node" parent="." unique_id=459607175]

[node name="FlashAnimator" type="AnimationPlayer" parent="Animators" unique_id=1426146992]
root_node = NodePath("../../Visual/Body")
libraries/ = SubResource("AnimationLibrary_0r4wo")

[node name="DeathAnimator" type="AnimationPlayer" parent="Animators" unique_id=928105458]
root_node = NodePath("../..")
libraries/ = SubResource("AnimationLibrary_jj6un")

[connection signal="got_hit" from="EntityStats" to="." method="_on_entity_stats_got_hit"]
[connection signal="out_of_health" from="EntityStats" to="." method="_on_entity_stats_out_of_health"]
[connection signal="animation_finished" from="Animators/DeathAnimator" to="." method="queue_free" unbinds=1]
